<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PyFlipbook for reshapes</title>
    <meta charset="utf-8" />
    <meta name="author" content="Gina Reynolds &amp; Suraj Thapa, May 2020" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# PyFlipbook for reshapes
## With {flipbookr} and xaringan
### Gina Reynolds &amp; Suraj Thapa, May 2020

---






---
# Import required packages




---

# Reshapes in python

- We are going to learn various ways to reshape using python. They are:

## 1. Melt
## 2. Stack and Unstack
## 3. Pivot

---
## Melt
- Think melt as shaping wide format to long format
- Create wide dataframe
---

---

count: false
 

.panel1-melt_df-1[

```python
student_scores = pd.DataFrame(
{"student": ["Andy", "Bernie", "Cindy", "Deb"],
"sex": ["M", "M", "F", "F"],
"english": [98, 95, 70, 40], # eng grades
"math": [66, 89, 60, 70], # math grades
"physics": [78, 90, 92, 88] # physics grades
})

student_scores
```
]
 
.panel2-melt_df-1[

```
   english  math  physics sex student
0       98    66       78   M    Andy
1       95    89       90   M  Bernie
2       70    60       92   F   Cindy
3       40    70       88   F     Deb
```
]

&lt;style&gt;
.panel1-melt_df-1 {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-melt_df-1 {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-melt_df-1 {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
### Melt example 1.i

- We are using only one column i.e. student

---



```python
student_scores
```

```
   english  math  physics sex student
0       98    66       78   M    Andy
1       95    89       90   M  Bernie
2       70    60       92   F   Cindy
3       40    70       88   F     Deb
```


---


```python
student_scores.melt(id_vars=['student', "sex"])
```

```
   student sex variable  value
0     Andy   M  english     98
1   Bernie   M  english     95
2    Cindy   F  english     70
3      Deb   F  english     40
4     Andy   M     math     66
5   Bernie   M     math     89
6    Cindy   F     math     60
7      Deb   F     math     70
8     Andy   M  physics     78
9   Bernie   M  physics     90
10   Cindy   F  physics     92
11     Deb   F  physics     88
```



---

&lt;!-- rather than 'previous columns' make the examples concrete --&gt;


```python
student_scores.melt(id_vars=['student', "sex"], var_name="subject")
```

```
   student sex  subject  value
0     Andy   M  english     98
1   Bernie   M  english     95
2    Cindy   F  english     70
3      Deb   F  english     40
4     Andy   M     math     66
5   Bernie   M     math     89
6    Cindy   F     math     60
7      Deb   F     math     70
8     Andy   M  physics     78
9   Bernie   M  physics     90
10   Cindy   F  physics     92
11     Deb   F  physics     88
```

---


```python
student_scores.melt(id_vars=['student', "sex"], var_name="subject", value_name="final_grade")
```

```
   student sex  subject  final_grade
0     Andy   M  english           98
1   Bernie   M  english           95
2    Cindy   F  english           70
3      Deb   F  english           40
4     Andy   M     math           66
5   Bernie   M     math           89
6    Cindy   F     math           60
7      Deb   F     math           70
8     Andy   M  physics           78
9   Bernie   M  physics           90
10   Cindy   F  physics           92
11     Deb   F  physics           88
```


---


```python
student_scores.melt(id_vars=['student', "sex"], var_name="subject", value_name="final_grade").sort_values(by=['final_grade'], ascending=False)
```

```
   student sex  subject  final_grade
0     Andy   M  english           98
1   Bernie   M  english           95
10   Cindy   F  physics           92
9   Bernie   M  physics           90
5   Bernie   M     math           89
11     Deb   F  physics           88
8     Andy   M  physics           78
2    Cindy   F  english           70
7      Deb   F     math           70
4     Andy   M     math           66
6    Cindy   F     math           60
3      Deb   F  english           40
```


---


```python
student_scores.melt(id_vars=['student', "sex"], var_name="subject", value_name="final_grade").sort_values(by=['final_grade'], ascending=False).head(3)
```

```
   student sex  subject  final_grade
0     Andy   M  english           98
1   Bernie   M  english           95
10   Cindy   F  physics           92
```



---

count: false
 

.panel1-hi-auto[

```python
*student_scores
```
]
 
.panel2-hi-auto[

```
   english  math  physics sex student
0       98    66       78   M    Andy
1       95    89       90   M  Bernie
2       70    60       92   F   Cindy
3       40    70       88   F     Deb
```
]

---
count: false
 

.panel1-hi-auto[

```python
student_scores \
* .melt(id_vars=['student', "sex"],
*       var_name="subject",
*       value_name="final_grade")
```
]
 
.panel2-hi-auto[

```
   student sex  subject  final_grade
0     Andy   M  english           98
1   Bernie   M  english           95
2    Cindy   F  english           70
3      Deb   F  english           40
4     Andy   M     math           66
5   Bernie   M     math           89
6    Cindy   F     math           60
7      Deb   F     math           70
8     Andy   M  physics           78
9   Bernie   M  physics           90
10   Cindy   F  physics           92
11     Deb   F  physics           88
```
]

---
count: false
 

.panel1-hi-auto[

```python
student_scores \
  .melt(id_vars=['student', "sex"],
        var_name="subject",
        value_name="final_grade") \
* .sort_values(by=['final_grade'], ascending=False)
```
]
 
.panel2-hi-auto[

```
   student sex  subject  final_grade
0     Andy   M  english           98
1   Bernie   M  english           95
10   Cindy   F  physics           92
9   Bernie   M  physics           90
5   Bernie   M     math           89
11     Deb   F  physics           88
8     Andy   M  physics           78
2    Cindy   F  english           70
7      Deb   F     math           70
4     Andy   M     math           66
6    Cindy   F     math           60
3      Deb   F  english           40
```
]

---
count: false
 

.panel1-hi-auto[

```python
student_scores \
  .melt(id_vars=['student', "sex"],
        var_name="subject",
        value_name="final_grade") \
  .sort_values(by=['final_grade'], ascending=False) \
* .head(3)
```
]
 
.panel2-hi-auto[

```
   student sex  subject  final_grade
0     Andy   M  english           98
1   Bernie   M  english           95
10   Cindy   F  physics           92
```
]

&lt;style&gt;
.panel1-hi-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-hi-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-hi-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;








---
### Melt example 1.ii
- We can use two or more columns
---


count: false
 

.panel1-melt_2-auto[

```python
*student_scores[student_scores.student !=
*                   'Andy']
```
]
 
.panel2-melt_2-auto[

```
   english  math  physics sex student
1       95    89       90   M  Bernie
2       70    60       92   F   Cindy
3       40    70       88   F     Deb
```
]

---
count: false
 

.panel1-melt_2-auto[

```python
student_scores[student_scores.student !=
                    'Andy'] \
* .drop('sex', axis=1)
```
]
 
.panel2-melt_2-auto[

```
   english  math  physics student
1       95    89       90  Bernie
2       70    60       92   Cindy
3       40    70       88     Deb
```
]

---
count: false
 

.panel1-melt_2-auto[

```python
student_scores[student_scores.student !=
                    'Andy'] \
  .drop('sex', axis=1) \
* .melt(value_vars = ['english', 'math',
*                     'physics'],
*       value_name = "final_grade")
```
]
 
.panel2-melt_2-auto[

```
  variable  final_grade
0  english           95
1  english           70
2  english           40
3     math           89
4     math           60
5     math           70
6  physics           90
7  physics           92
8  physics           88
```
]

---
count: false
 

.panel1-melt_2-auto[

```python
student_scores[student_scores.student !=
                    'Andy'] \
  .drop('sex', axis=1) \
  .melt(value_vars = ['english', 'math',
                      'physics'],
        value_name = "final_grade") \
* .sort_values(by = ['final_grade'])
```
]
 
.panel2-melt_2-auto[

```
  variable  final_grade
2  english           40
4     math           60
1  english           70
5     math           70
8  physics           88
3     math           89
6  physics           90
7  physics           92
0  english           95
```
]

---
count: false
 

.panel1-melt_2-auto[

```python
student_scores[student_scores.student !=
                    'Andy'] \
  .drop('sex', axis=1) \
  .melt(value_vars = ['english', 'math',
                      'physics'],
        value_name = "final_grade") \
  .sort_values(by = ['final_grade']) \
* .tail(5)
```
]
 
.panel2-melt_2-auto[

```
  variable  final_grade
8  physics           88
3     math           89
6  physics           90
7  physics           92
0  english           95
```
]

&lt;style&gt;
.panel1-melt_2-auto {
  color: black;
  width: 49%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-melt_2-auto {
  color: black;
  width: 49%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-melt_2-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;








---
## Stack and Unstack

- Stack increases the index level i.e.
(a) for simple df creates index-columns pairs 
(b) If dataframe has multi-level index, stack increases the index level

### Stack 1.i
- Let's tackle (a). It will create index-columns pairs. For illustrative purpose 
we will set index by ourself and then stack

---

count: false
 

.panel1-stack_1-auto[

```python
*df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
*                  'summer':[22,25,28],
*                  'winter':[15,5,0],})
```
]
 
.panel2-stack_1-auto[

]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
*df1
```
]
 
.panel2-stack_1-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
* .set_index('summer')
```
]
 
.panel2-stack_1-auto[

```
           city  winter
summer                 
22           SF      15
25       Boston       5
28      Chicago       0
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
* .stack()
```
]
 
.panel2-stack_1-auto[

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
* .index
```
]
 
.panel2-stack_1-auto[

```
MultiIndex(levels=[[22, 25, 28], ['city', 'winter']],
           labels=[[0, 0, 1, 1, 2, 2], [0, 1, 0, 1, 0, 1]],
           names=['summer', None])
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
* .levels
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

*df1
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
* .set_index('summer')
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
           city  winter
summer                 
22           SF      15
25       Boston       5
28      Chicago       0
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
* .stack()
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
  .stack() \
* .shape
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
(6,)
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
  .stack() \
  .shape

*df1
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
(6,)
```

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
  .stack() \
  .shape

df1 \
* .set_index('summer')
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
(6,)
```

```
           city  winter
summer                 
22           SF      15
25       Boston       5
28      Chicago       0
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
  .stack() \
  .shape

df1 \
  .set_index('summer') \
* .stack()
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
(6,)
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
  .stack() \
  .shape

df1 \
  .set_index('summer') \
  .stack() \
* .index[0] #It's a multiindex now
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
(6,)
```

```
(22, 'city')
```
]

---
count: false
 

.panel1-stack_1-auto[

```python
df1 = pd.DataFrame({'city':['SF','Boston','Chicago'],
                   'summer':[22,25,28],
                   'winter':[15,5,0],})
df1 \
  .set_index('summer') \
  .stack() \
  .index \
  .levels

df1 \
  .set_index('summer') \
  .stack() \
  .shape

df1 \
  .set_index('summer') \
  .stack() \
  .index[0] #It's a multiindex now
```
]
 
.panel2-stack_1-auto[

```
FrozenList([[22, 25, 28], ['city', 'winter']])
```

```
(6,)
```

```
(22, 'city')
```
]

&lt;style&gt;
.panel1-stack_1-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-stack_1-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-stack_1-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
### Stack 1.i
- Still tackling (a). We know it creates index-columns pairs. What if we want a normal dataframe (no multi-level index) ? Answer :  we can just use reset_index

---

count: false
 

.panel1-stack_2-auto[

```python
*df1
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

*day1_index_df = df1.set_index('summer')
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

*day1_index_df.stack() #Previous slide
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

day1_index_df.stack() #Previous slide

*day1_index_df.stack().reset_index() #Normal dataframe
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```

```
   summer level_1        0
0      22    city       SF
1      22  winter       15
2      25    city   Boston
3      25  winter        5
4      28    city  Chicago
5      28  winter        0
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

day1_index_df.stack() #Previous slide

day1_index_df.stack().reset_index() #Normal dataframe

*#This is no longer available :
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```

```
   summer level_1        0
0      22    city       SF
1      22  winter       15
2      25    city   Boston
3      25  winter        5
4      28    city  Chicago
5      28  winter        0
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

day1_index_df.stack() #Previous slide

day1_index_df.stack().reset_index() #Normal dataframe

#This is no longer available :
*# day1_index_df.stack().reset_index().index.levels
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```

```
   summer level_1        0
0      22    city       SF
1      22  winter       15
2      25    city   Boston
3      25  winter        5
4      28    city  Chicago
5      28  winter        0
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

day1_index_df.stack() #Previous slide

day1_index_df.stack().reset_index() #Normal dataframe

#This is no longer available :
# day1_index_df.stack().reset_index().index.levels
*day1_index_df.stack().reset_index().shape
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```

```
   summer level_1        0
0      22    city       SF
1      22  winter       15
2      25    city   Boston
3      25  winter        5
4      28    city  Chicago
5      28  winter        0
```

```
(6, 3)
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

day1_index_df.stack() #Previous slide

day1_index_df.stack().reset_index() #Normal dataframe

#This is no longer available :
# day1_index_df.stack().reset_index().index.levels
day1_index_df.stack().reset_index().shape
*day1_index_df.stack().reset_index().index[0]
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```

```
   summer level_1        0
0      22    city       SF
1      22  winter       15
2      25    city   Boston
3      25  winter        5
4      28    city  Chicago
5      28  winter        0
```

```
(6, 3)
```

```
0
```
]

---
count: false
 

.panel1-stack_2-auto[

```python
df1

day1_index_df = df1.set_index('summer')

day1_index_df.stack() #Previous slide

day1_index_df.stack().reset_index() #Normal dataframe

#This is no longer available :
# day1_index_df.stack().reset_index().index.levels
day1_index_df.stack().reset_index().shape
day1_index_df.stack().reset_index().index[0]
```
]
 
.panel2-stack_2-auto[

```
      city  summer  winter
0       SF      22      15
1   Boston      25       5
2  Chicago      28       0
```

```
summer        
22      city           SF
        winter         15
25      city       Boston
        winter          5
28      city      Chicago
        winter          0
dtype: object
```

```
   summer level_1        0
0      22    city       SF
1      22  winter       15
2      25    city   Boston
3      25  winter        5
4      28    city  Chicago
5      28  winter        0
```

```
(6, 3)
```

```
0
```
]

&lt;style&gt;
.panel1-stack_2-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-stack_2-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-stack_2-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
### Stack 1.ii

- Let's tackle (b) which is : If dataframe has multi-level index, stack increases the index level.

- First we will create a multi-level index dataframe and check levels. Notice the difference between output of print(df2.index.levels) and df2.index.levels.

- to_frame() function is used to convert the given series object to a dataframe. 

---

count: false
 

.panel1-stack_3-auto[

```python
*tuples = [('A',1),
*         ('A',2),
*         ('A',3),
*         ('B',1),
*         ('A',2)]
```
]
 
.panel2-stack_3-auto[

]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

*index = pd.MultiIndex.from_tuples(tuples,
*names=['first','second'])
```
]
 
.panel2-stack_3-auto[

]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
*df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
*                  index=index, columns=['column_x', 'column_y'])
```
]
 
.panel2-stack_3-auto[

]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
                   index=index, columns=['column_x', 'column_y'])
*df2
```
]
 
.panel2-stack_3-auto[

```
              column_x  column_y
first second                    
A     1              9         0
      2              4         1
      3              4         2
B     1              6         1
A     2              9         4
```
]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
                   index=index, columns=['column_x', 'column_y'])
df2 \
* .index
```
]
 
.panel2-stack_3-auto[

```
MultiIndex(levels=[['A', 'B'], [1, 2, 3]],
           labels=[[0, 0, 0, 1, 0], [0, 1, 2, 0, 1]],
           names=['first', 'second'])
```
]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
                   index=index, columns=['column_x', 'column_y'])
df2 \
  .index \
* .levels
```
]
 
.panel2-stack_3-auto[

```
FrozenList([['A', 'B'], [1, 2, 3]])
```
]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
                   index=index, columns=['column_x', 'column_y'])
df2 \
  .index \
  .levels

*len(df2.index.levels)
```
]
 
.panel2-stack_3-auto[

```
FrozenList([['A', 'B'], [1, 2, 3]])
```

```
2
```
]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
                   index=index, columns=['column_x', 'column_y'])
df2 \
  .index \
  .levels

len(df2.index.levels)
*print(df2.index.levels)
```
]
 
.panel2-stack_3-auto[

```
FrozenList([['A', 'B'], [1, 2, 3]])
```

```
2
```

```
[['A', 'B'], [1, 2, 3]]
```
]

---
count: false
 

.panel1-stack_3-auto[

```python
tuples = [('A',1),
          ('A',2),
          ('A',3),
          ('B',1),
          ('A',2)]

index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(5,2)),
                   index=index, columns=['column_x', 'column_y'])
df2 \
  .index \
  .levels

len(df2.index.levels)
print(df2.index.levels)
*df2.index.levels
```
]
 
.panel2-stack_3-auto[

```
FrozenList([['A', 'B'], [1, 2, 3]])
```

```
2
```

```
[['A', 'B'], [1, 2, 3]]
```

```
FrozenList([['A', 'B'], [1, 2, 3]])
```
]

&lt;style&gt;
.panel1-stack_3-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-stack_3-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-stack_3-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;




```
FrozenList([['A', 'B'], [1, 2, 3]])
```

```
2
```

```
[['A', 'B'], [1, 2, 3]]
```

```
FrozenList([['A', 'B'], [1, 2, 3]])
```

---
- Now, let's stack these.

- Remember : to_frame() function is used to convert the given series object to a dataframe.

---

count: false
 

.panel1-stack_4-auto[

```python
*df2
```
]
 
.panel2-stack_4-auto[

```
              column_x  column_y
first second                    
A     1              6         1
      2              1         5
      3              1         7
B     1              9         2
A     2              0         3
```
]

---
count: false
 

.panel1-stack_4-auto[

```python
df2 \
* .stack()
```
]
 
.panel2-stack_4-auto[

```
first  second          
A      1       column_x    6
               column_y    1
       2       column_x    1
               column_y    5
       3       column_x    1
               column_y    7
B      1       column_x    9
               column_y    2
A      2       column_x    0
               column_y    3
dtype: int64
```
]

---
count: false
 

.panel1-stack_4-auto[

```python
df2 \
  .stack() \
* .to_frame()
```
]
 
.panel2-stack_4-auto[

```
                       0
first second            
A     1      column_x  6
             column_y  1
      2      column_x  1
             column_y  5
      3      column_x  1
             column_y  7
B     1      column_x  9
             column_y  2
A     2      column_x  0
             column_y  3
```
]

&lt;style&gt;
.panel1-stack_4-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-stack_4-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-stack_4-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
- Now, let's check the index levels.

---

count: false
 

.panel1-stack_5-auto[

```python
*len(df2.stack().to_frame().index.levels)
```
]
 
.panel2-stack_5-auto[

```
3
```
]

---
count: false
 

.panel1-stack_5-auto[

```python
len(df2.stack().to_frame().index.levels)
*print(df2.stack().to_frame().index.levels)
```
]
 
.panel2-stack_5-auto[

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```
]

---
count: false
 

.panel1-stack_5-auto[

```python
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
*df2.stack().to_frame().index.levels
```
]
 
.panel2-stack_5-auto[

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```
]

---
count: false
 

.panel1-stack_5-auto[

```python
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2.stack().to_frame().index.levels
```
]
 
.panel2-stack_5-auto[

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```
]

&lt;style&gt;
.panel1-stack_5-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-stack_5-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-stack_5-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;





---
### UNSTACK

- It's the opposite of stack.

---

count: false
 

.panel1-stack_6-auto[

```python
*tuples = [('A',1),('A',2),('A',3),('B',1)]
```
]
 
.panel2-stack_6-auto[

]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
*index = pd.MultiIndex.from_tuples(tuples,
*names=['first','second'])
```
]
 
.panel2-stack_6-auto[

]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
*df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
*                  index=index, columns=['column_x', 'column_y'])
```
]
 
.panel2-stack_6-auto[

]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
*df2
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              0         9
      2              2         6
      3              9         8
B     1              2         4
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
*len(df2.stack().to_frame().index.levels)
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              1         0
      2              4         9
      3              4         2
B     1              0         7
```

```
3
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
*print(df2.stack().to_frame().index.levels)
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              0         4
      2              0         7
      3              5         8
B     1              4         6
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
*df2
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              8         8
      2              7         7
      3              3         9
B     1              0         2
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
              column_x  column_y
first second                    
A     1              8         8
      2              7         7
      3              3         9
B     1              0         2
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
* .stack()
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              0         8
      2              5         0
      3              6         1
B     1              8         4
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
first  second          
A      1       column_x    0
               column_y    8
       2       column_x    5
               column_y    0
       3       column_x    6
               column_y    1
B      1       column_x    8
               column_y    4
dtype: int64
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
* .to_frame()
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              7         9
      2              4         0
      3              7         7
B     1              9         1
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
                       0
first second            
A     1      column_x  7
             column_y  9
      2      column_x  4
             column_y  0
      3      column_x  7
             column_y  7
B     1      column_x  9
             column_y  1
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
* .index
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              0         6
      2              2         6
      3              9         9
B     1              1         6
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
MultiIndex(levels=[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']],
           labels=[[0, 0, 0, 0, 0, 0, 1, 1], [0, 0, 1, 1, 2, 2, 0, 0], [0, 1, 0, 1, 0, 1, 0, 1]],
           names=['first', 'second', None])
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
* .levels
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              0         2
      2              7         0
      3              0         7
B     1              7         6
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
  .levels

*stacked_df = df2.stack().to_frame()
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              4         5
      2              9         4
      3              1         6
B     1              4         4
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
  .levels

stacked_df = df2.stack().to_frame()

*stacked_df.unstack()
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              3         0
      2              5         0
      3              5         8
B     1              0         9
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```

```
                    0         
             column_x column_y
first second                  
A     1             3        0
      2             5        0
      3             5        8
B     1             0        9
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
  .levels

stacked_df = df2.stack().to_frame()

stacked_df.unstack()
*len(stacked_df.unstack().index.levels)
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              1         7
      2              4         6
      3              7         3
B     1              4         5
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```

```
                    0         
             column_x column_y
first second                  
A     1             1        7
      2             4        6
      3             7        3
B     1             4        5
```

```
2
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
  .levels

stacked_df = df2.stack().to_frame()

stacked_df.unstack()
len(stacked_df.unstack().index.levels)
*print(stacked_df.unstack().index.levels)
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              0         7
      2              4         2
      3              3         8
B     1              7         3
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```

```
                    0         
             column_x column_y
first second                  
A     1             0        7
      2             4        2
      3             3        8
B     1             7        3
```

```
2
```

```
[['A', 'B'], [1, 2, 3]]
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
  .levels

stacked_df = df2.stack().to_frame()

stacked_df.unstack()
len(stacked_df.unstack().index.levels)
print(stacked_df.unstack().index.levels)
*stacked_df.unstack().index.levels
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              3         0
      2              2         7
      3              1         9
B     1              8         6
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```

```
                    0         
             column_x column_y
first second                  
A     1             3        0
      2             2        7
      3             1        9
B     1             8        6
```

```
2
```

```
[['A', 'B'], [1, 2, 3]]
```

```
FrozenList([['A', 'B'], [1, 2, 3]])
```
]

---
count: false
 

.panel1-stack_6-auto[

```python
tuples = [('A',1),('A',2),('A',3),('B',1)]
index = pd.MultiIndex.from_tuples(tuples,
names=['first','second'])
df2 = pd.DataFrame(np.random.randint(10, size=(4,2)),
                   index=index, columns=['column_x', 'column_y'])
df2
len(df2.stack().to_frame().index.levels)
print(df2.stack().to_frame().index.levels)
df2 \
  .stack() \
  .to_frame() \
  .index \
  .levels

stacked_df = df2.stack().to_frame()

stacked_df.unstack()
len(stacked_df.unstack().index.levels)
print(stacked_df.unstack().index.levels)
stacked_df.unstack().index.levels
```
]
 
.panel2-stack_6-auto[

```
              column_x  column_y
first second                    
A     1              5         8
      2              8         7
      3              5         1
B     1              0         8
```

```
3
```

```
[['A', 'B'], [1, 2, 3], ['column_x', 'column_y']]
```

```
FrozenList([['A', 'B'], [1, 2, 3], ['column_x', 'column_y']])
```

```
                    0         
             column_x column_y
first second                  
A     1             5        8
      2             8        7
      3             5        1
B     1             0        8
```

```
2
```

```
[['A', 'B'], [1, 2, 3]]
```

```
FrozenList([['A', 'B'], [1, 2, 3]])
```
]

&lt;style&gt;
.panel1-stack_6-auto {
  color: black;
  width: 38.6060606060606%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-stack_6-auto {
  color: black;
  width: 59.3939393939394%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-stack_6-auto {
  color: black;
  width: NA%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;






---


&lt;style type="text/css"&gt;
.remark-code{line-height: 1.5; font-size: 80%}
&lt;/style&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:10",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
