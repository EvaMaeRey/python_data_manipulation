<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PyFlipbook - Merge parameters</title>
    <meta charset="utf-8" />
    <meta name="author" content="Suraj Thapa and Gina Reynolds, May 2020" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/ninjutsu.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# PyFlipbook - Merge parameters
## With {flipbookr} and xaringan
### Suraj Thapa and Gina Reynolds, May 2020

---








---
# Import required packages

class: split-40
count: false
 

 
.column[.content[

```python
*import numpy as np
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
import numpy as np  
*import pandas as pd
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
import numpy as np  
import pandas as pd  
*from vega_datasets import data
```
]]
.column[.content[

]]


```python
import numpy as np
import pandas as pd
from vega_datasets import data
```
---

# Using Merge 
---
### Let's get data ready first
---
class: split-40
count: false
 

 
.column[.content[

```python
*countries=['China','United States','Argentina','Norway']
 
countries
```
]]
.column[.content[

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
*df = data.countries()
 
countries
```
]]
.column[.content[

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
*df.head()
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
*df = df[df.country.isin(countries)]
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
*df = df.reset_index(drop=True)
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

*df.head()
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

*df1 = df.iloc[[24,35], [1,3,8]]
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

df1 = df.iloc[[24,35], [1,3,8]]  
*df1 = df1.reset_index(drop=True)
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

df1 = df.iloc[[24,35], [1,3,8]]  
df1 = df1.reset_index(drop=True)  
*df1
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

df1 = df.iloc[[24,35], [1,3,8]]  
df1 = df1.reset_index(drop=True)  
df1  

*df2 = df.iloc[[5,10,24,25,34,35], [1,6,7]]
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

df1 = df.iloc[[24,35], [1,3,8]]  
df1 = df1.reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7]]  
*df2 = df2.reset_index(drop=True)
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

df1 = df.iloc[[24,35], [1,3,8]]  
df1 = df1.reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7]]  
df2 = df2.reset_index(drop=True)  
*df2
 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
countries=['China','United States','Argentina','Norway']  
df = data.countries()  
df.head()  
df = df[df.country.isin(countries)]  
df = df.reset_index(drop=True)  

df.head()  

df1 = df.iloc[[24,35], [1,3,8]]  
df1 = df1.reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7]]  
df2 = df2.reset_index(drop=True)  
df2  

 
countries
```
]]
.column[.content[

```
                         _comment      country  fertility  life_expect  \
0  Data courtesy of Gapminder.org  Afghanistan        7.7       30.332   
1                             NaN  Afghanistan        7.7       31.997   
2                             NaN  Afghanistan        7.7       34.020   
3                             NaN  Afghanistan        7.7       36.088   
4                             NaN  Afghanistan        7.7       38.438   

   n_fertility  n_life_expect  p_fertility  p_life_expect  year  
0          7.7         31.997          NaN            NaN  1955  
1          7.7         34.020          7.7         30.332  1960  
2          7.7         36.088          7.7         31.997  1965  
3          7.7         38.438          7.7         34.020  1970  
4          7.8         39.854          7.7         36.088  1975  
```

```
  _comment    country  fertility  life_expect  n_fertility  n_life_expect  \
0      NaN  Argentina     3.1265       64.399       3.0895         65.142   
1      NaN  Argentina     3.0895       65.142       3.0490         65.634   
2      NaN  Argentina     3.0490       65.634       3.1455         67.065   
3      NaN  Argentina     3.1455       67.065       3.4400         68.481   
4      NaN  Argentina     3.4400       68.481       3.1500         69.942   

   p_fertility  p_life_expect  year  
0          NaN            NaN  1955  
1       3.1265         64.399  1960  
2       3.0895         65.142  1965  
3       3.0490         65.634  1970  
4       3.1455         67.065  1975  
```

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
['China', 'United States', 'Argentina', 'Norway']
```
]]


```python
countries=['China','United States','Argentina','Norway']
df = data.countries()
df.head()
df = df[df.country.isin(countries)]
df = df.reset_index(drop=True)

df.head()

df1 = df.iloc[[24,35], [1,3,8]]
df1 = df1.reset_index(drop=True)
df1

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7]]
df2 = df2.reset_index(drop=True)
df2
```

---
### Parameter *left* &amp; *right*
- left is first dataframe you enter and right is second dataframe you enter
  + right dataframe is object to merge with
  
- Arrange cols will help us to get columns in that order
- Remember left df is first df and right df is second df
  
---
class: split-40
count: false
 

 
.column[.content[

```python
*df1
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  
*df2
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  
df2  
*arrange_cols = ['country','year', 'life_expect', 'p_fertility', 'p_life_expect']
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  
df2  
arrange_cols = ['country','year', 'life_expect', 'p_fertility', 'p_life_expect']  
*pd.merge(df1,df2)[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```
]]


---

### Parameter *how* 
- how : {'left', 'right', 'outer', 'inner'}
- outer: use union of keys from both frames, similar to a SQL full outer join; sort keys lexicographically.
- inner: use intersection of keys from both frames, similar to a SQL inner join; preserve the order of the left keys.
- default is 'inner' (see the difference between inner which is `no arguments` vs outer)
---

class: split-40
count: false
 

 
.column[.content[

```python
*#Using parameter : how - inner {default}
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
*df1
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
*df2
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
*pd.merge(df1,df2)
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
pd.merge(df1,df2)  
*pd.merge(df2,df1)
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```

```
         country  p_fertility  p_life_expect  life_expect  year
0         Norway        2.248          74.34        75.37  1975
1         Norway        1.810          75.37        75.37  1975
2  United States        2.016          71.34        74.65  1980
3  United States        1.788          73.38        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
pd.merge(df1,df2)  
pd.merge(df2,df1)  

*#Using how parameter : outer
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```

```
         country  p_fertility  p_life_expect  life_expect  year
0         Norway        2.248          74.34        75.37  1975
1         Norway        1.810          75.37        75.37  1975
2  United States        2.016          71.34        74.65  1980
3  United States        1.788          73.38        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
pd.merge(df1,df2)  
pd.merge(df2,df1)  

#Using how parameter : outer  
*pd.merge(df1,df2, how='outer')
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```

```
         country  p_fertility  p_life_expect  life_expect  year
0         Norway        2.248          74.34        75.37  1975
1         Norway        1.810          75.37        75.37  1975
2  United States        2.016          71.34        74.65  1980
3  United States        1.788          73.38        74.65  1980
```

```
         country  life_expect    year  p_fertility  p_life_expect
0         Norway        75.37  1975.0        2.248         74.340
1         Norway        75.37  1975.0        1.810         75.370
2  United States        74.65  1980.0        2.016         71.340
3  United States        74.65  1980.0        1.788         73.380
4      Argentina          NaN     NaN        3.440         68.481
5          China          NaN     NaN          NaN            NaN
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
pd.merge(df1,df2)  
pd.merge(df2,df1)  

#Using how parameter : outer  
pd.merge(df1,df2, how='outer')  
*pd.merge(df2,df1, how='outer')
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```

```
         country  p_fertility  p_life_expect  life_expect  year
0         Norway        2.248          74.34        75.37  1975
1         Norway        1.810          75.37        75.37  1975
2  United States        2.016          71.34        74.65  1980
3  United States        1.788          73.38        74.65  1980
```

```
         country  life_expect    year  p_fertility  p_life_expect
0         Norway        75.37  1975.0        2.248         74.340
1         Norway        75.37  1975.0        1.810         75.370
2  United States        74.65  1980.0        2.016         71.340
3  United States        74.65  1980.0        1.788         73.380
4      Argentina          NaN     NaN        3.440         68.481
5          China          NaN     NaN          NaN            NaN
```

```
         country  p_fertility  p_life_expect  life_expect    year
0      Argentina        3.440         68.481          NaN     NaN
1          China          NaN            NaN          NaN     NaN
2         Norway        2.248         74.340        75.37  1975.0
3         Norway        1.810         75.370        75.37  1975.0
4  United States        2.016         71.340        74.65  1980.0
5  United States        1.788         73.380        74.65  1980.0
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
pd.merge(df1,df2)  
pd.merge(df2,df1)  

#Using how parameter : outer  
pd.merge(df1,df2, how='outer')  
pd.merge(df2,df1, how='outer')  
*#Keys are ordered in terms of left dataframe
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```

```
         country  p_fertility  p_life_expect  life_expect  year
0         Norway        2.248          74.34        75.37  1975
1         Norway        1.810          75.37        75.37  1975
2  United States        2.016          71.34        74.65  1980
3  United States        1.788          73.38        74.65  1980
```

```
         country  life_expect    year  p_fertility  p_life_expect
0         Norway        75.37  1975.0        2.248         74.340
1         Norway        75.37  1975.0        1.810         75.370
2  United States        74.65  1980.0        2.016         71.340
3  United States        74.65  1980.0        1.788         73.380
4      Argentina          NaN     NaN        3.440         68.481
5          China          NaN     NaN          NaN            NaN
```

```
         country  p_fertility  p_life_expect  life_expect    year
0      Argentina        3.440         68.481          NaN     NaN
1          China          NaN            NaN          NaN     NaN
2         Norway        2.248         74.340        75.37  1975.0
3         Norway        1.810         75.370        75.37  1975.0
4  United States        2.016         71.340        74.65  1980.0
5  United States        1.788         73.380        74.65  1980.0
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using parameter : how - inner {default}  
df1  
df2  
pd.merge(df1,df2)  
pd.merge(df2,df1)  

#Using how parameter : outer  
pd.merge(df1,df2, how='outer')  
pd.merge(df2,df1, how='outer')  
#Keys are ordered in terms of left dataframe  
*#Again - outer: use union of keys from both frames
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1         Norway        75.37  1975        1.810          75.37
2  United States        74.65  1980        2.016          71.34
3  United States        74.65  1980        1.788          73.38
```

```
         country  p_fertility  p_life_expect  life_expect  year
0         Norway        2.248          74.34        75.37  1975
1         Norway        1.810          75.37        75.37  1975
2  United States        2.016          71.34        74.65  1980
3  United States        1.788          73.38        74.65  1980
```

```
         country  life_expect    year  p_fertility  p_life_expect
0         Norway        75.37  1975.0        2.248         74.340
1         Norway        75.37  1975.0        1.810         75.370
2  United States        74.65  1980.0        2.016         71.340
3  United States        74.65  1980.0        1.788         73.380
4      Argentina          NaN     NaN        3.440         68.481
5          China          NaN     NaN          NaN            NaN
```

```
         country  p_fertility  p_life_expect  life_expect    year
0      Argentina        3.440         68.481          NaN     NaN
1          China          NaN            NaN          NaN     NaN
2         Norway        2.248         74.340        75.37  1975.0
3         Norway        1.810         75.370        75.37  1975.0
4  United States        2.016         71.340        74.65  1980.0
5  United States        1.788         73.380        74.65  1980.0
```
]]



---
### Parameter *how* {'left', 'right', 'outer', 'inner'}
#### Using left and right
- Right: use only keys from right frame, similar to a SQL right outer join; preserve key order.
- left: use only keys from left frame, similar to a SQL left outer join; preserve key order.
- In other words, it gives you option to keep all rows (and its order) of which dataframe
---

class: split-40
count: false
 

 
.column[.content[

```python
*#Using left
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
*df1
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
*df2
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

*pd.merge(df1,df2, how='left')[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
*pd.merge(df2,df1, how='left')[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
pd.merge(df2,df1, how='left')[arrange_cols]  
*#left: use only keys from left frame, preserve key order
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
pd.merge(df2,df1, how='left')[arrange_cols]  
#left: use only keys from left frame, preserve key order  

*#Using right
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
pd.merge(df2,df1, how='left')[arrange_cols]  
#left: use only keys from left frame, preserve key order  

#Using right  
*#left: use only keys from right frame, preserve key order
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
pd.merge(df2,df1, how='left')[arrange_cols]  
#left: use only keys from left frame, preserve key order  

#Using right  
#left: use only keys from right frame, preserve key order  
*pd.merge(df1,df2, how='right')[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```

```
         country    year  life_expect  p_fertility  p_life_expect
0         Norway  1975.0        75.37        2.248         74.340
1         Norway  1975.0        75.37        1.810         75.370
2  United States  1980.0        74.65        2.016         71.340
3  United States  1980.0        74.65        1.788         73.380
4      Argentina     NaN          NaN        3.440         68.481
5          China     NaN          NaN          NaN            NaN
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
pd.merge(df2,df1, how='left')[arrange_cols]  
#left: use only keys from left frame, preserve key order  

#Using right  
#left: use only keys from right frame, preserve key order  
pd.merge(df1,df2, how='right')[arrange_cols]  
*pd.merge(df2,df1, how='right')[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```

```
         country    year  life_expect  p_fertility  p_life_expect
0         Norway  1975.0        75.37        2.248         74.340
1         Norway  1975.0        75.37        1.810         75.370
2  United States  1980.0        74.65        2.016         71.340
3  United States  1980.0        74.65        1.788         73.380
4      Argentina     NaN          NaN        3.440         68.481
5          China     NaN          NaN          NaN            NaN
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using left  
df1  
df2  

pd.merge(df1,df2, how='left')[arrange_cols]  
pd.merge(df2,df1, how='left')[arrange_cols]  
#left: use only keys from left frame, preserve key order  

#Using right  
#left: use only keys from right frame, preserve key order  
pd.merge(df1,df2, how='right')[arrange_cols]  
pd.merge(df2,df1, how='right')[arrange_cols]  
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect
0      Argentina        3.440         68.481
1          China          NaN            NaN
2         Norway        2.248         74.340
3         Norway        1.810         75.370
4  United States        2.016         71.340
5  United States        1.788         73.380
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```

```
         country    year  life_expect  p_fertility  p_life_expect
0      Argentina     NaN          NaN        3.440         68.481
1          China     NaN          NaN          NaN            NaN
2         Norway  1975.0        75.37        2.248         74.340
3         Norway  1975.0        75.37        1.810         75.370
4  United States  1980.0        74.65        2.016         71.340
5  United States  1980.0        74.65        1.788         73.380
```

```
         country    year  life_expect  p_fertility  p_life_expect
0         Norway  1975.0        75.37        2.248         74.340
1         Norway  1975.0        75.37        1.810         75.370
2  United States  1980.0        74.65        2.016         71.340
3  United States  1980.0        74.65        1.788         73.380
4      Argentina     NaN          NaN        3.440         68.481
5          China     NaN          NaN          NaN            NaN
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248          74.34
1         Norway  1975        75.37        1.810          75.37
2  United States  1980        74.65        2.016          71.34
3  United States  1980        74.65        1.788          73.38
```
]]



---
### Parameter *on*
- on : label or list
- Column or index level names to join on. These must be found in both DataFrames. If on is *None* and not merging on indexes then this defaults to the intersection of the columns in both DataFrames.
- we will focus on columns only for now.
---
class: split-40
count: false
 

 
.column[.content[

```python
*df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
*df1_i
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

*df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
*df2
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

*#Let's merge using one column vs two columns
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

#Let's merge using one column vs two columns  

*#Using one column
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

#Let's merge using one column vs two columns  

#Using one column  
*pd.merge(df1_i, df2, on=['year'])
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
       country_x  life_expect  year      country_y  p_fertility  p_life_expect
0         Norway        75.37  1975         Norway        2.248         74.340
1         Norway        75.37  1975  United States        2.016         71.340
2  United States        74.65  1980      Argentina        3.440         68.481
3  United States        74.65  1980         Norway        1.810         75.370
4  United States        74.65  1980  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

#Let's merge using one column vs two columns  

#Using one column  
pd.merge(df1_i, df2, on=['year'])  
*#Comments
* #When merged using year, since default is inner
*  #and left dataframe, it merges years of left_df
*  #(i.e. df1_i) with right_df
* #This means it will find all 1975 and 1980
*   #on right_df and keep them as well
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
       country_x  life_expect  year      country_y  p_fertility  p_life_expect
0         Norway        75.37  1975         Norway        2.248         74.340
1         Norway        75.37  1975  United States        2.016         71.340
2  United States        74.65  1980      Argentina        3.440         68.481
3  United States        74.65  1980         Norway        1.810         75.370
4  United States        74.65  1980  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

#Let's merge using one column vs two columns  

#Using one column  
pd.merge(df1_i, df2, on=['year'])  
#Comments  
  #When merged using year, since default is inner  
   #and left dataframe, it merges years of left_df  
   #(i.e. df1_i) with right_df  
  #This means it will find all 1975 and 1980  
    #on right_df and keep them as well  

*#Using two columns
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
       country_x  life_expect  year      country_y  p_fertility  p_life_expect
0         Norway        75.37  1975         Norway        2.248         74.340
1         Norway        75.37  1975  United States        2.016         71.340
2  United States        74.65  1980      Argentina        3.440         68.481
3  United States        74.65  1980         Norway        1.810         75.370
4  United States        74.65  1980  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

#Let's merge using one column vs two columns  

#Using one column  
pd.merge(df1_i, df2, on=['year'])  
#Comments  
  #When merged using year, since default is inner  
   #and left dataframe, it merges years of left_df  
   #(i.e. df1_i) with right_df  
  #This means it will find all 1975 and 1980  
    #on right_df and keep them as well  

#Using two columns  
*pd.merge(df1_i, df2, on=['year','country'])
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
       country_x  life_expect  year      country_y  p_fertility  p_life_expect
0         Norway        75.37  1975         Norway        2.248         74.340
1         Norway        75.37  1975  United States        2.016         71.340
2  United States        74.65  1980      Argentina        3.440         68.481
3  United States        74.65  1980         Norway        1.810         75.370
4  United States        74.65  1980  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1  United States        74.65  1980        1.788          73.38
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1_i = df.iloc[[24,35], [1,3,8]].reset_index(drop=True)  
df1_i  

df2 = df.iloc[[5,10,24,25,34,35], [1,6,7,8]].reset_index(drop=True)  
df2  

#Let's merge using one column vs two columns  

#Using one column  
pd.merge(df1_i, df2, on=['year'])  
#Comments  
  #When merged using year, since default is inner  
   #and left dataframe, it merges years of left_df  
   #(i.e. df1_i) with right_df  
  #This means it will find all 1975 and 1980  
    #on right_df and keep them as well  

#Using two columns  
pd.merge(df1_i, df2, on=['year','country'])  
*# Comment
*#   - This matches both year and country first
* #  - We can use inner (default), outer, left, right as well
* #depending upon need
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
       country_x  life_expect  year      country_y  p_fertility  p_life_expect
0         Norway        75.37  1975         Norway        2.248         74.340
1         Norway        75.37  1975  United States        2.016         71.340
2  United States        74.65  1980      Argentina        3.440         68.481
3  United States        74.65  1980         Norway        1.810         75.370
4  United States        74.65  1980  United States        1.788         73.380
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1  United States        74.65  1980        1.788          73.38
```
]]


---

---
class: split-40
count: false
 

 
.column[.content[

```python
#Using *how* parameter with parameter *on*  
df1_i  
df2  

#pd.merge(df1_i, df2, on=['year','country']) #ROTATE  

#Now using *how* parameter with parameter *on*  
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using *how* parameter with parameter *on*  
df1_i  
df2  


#Now using *how* parameter with parameter *on*  
*pd.merge(df1_i, df2, on=['year','country'], how="inner") #ROTATE
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1  United States        74.65  1980        1.788          73.38
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using *how* parameter with parameter *on*  
df1_i  
df2  


#Now using *how* parameter with parameter *on*  
*pd.merge(df1_i, df2, on=['year','country'], how="outer") #ROTATE
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248         74.340
1  United States        74.65  1980        1.788         73.380
2      Argentina          NaN  1980        3.440         68.481
3          China          NaN  1955          NaN            NaN
4         Norway          NaN  1980        1.810         75.370
5  United States          NaN  1975        2.016         71.340
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using *how* parameter with parameter *on*  
df1_i  
df2  


#Now using *how* parameter with parameter *on*  
*pd.merge(df1_i, df2, on=['year','country'], how="left") #ROTATE
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248          74.34
1  United States        74.65  1980        1.788          73.38
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
#Using *how* parameter with parameter *on*  
df1_i  
df2  


#Now using *how* parameter with parameter *on*  
*pd.merge(df1_i, df2, on=['year','country'], how="right") #ROTATE
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
         country  p_fertility  p_life_expect  year
0      Argentina        3.440         68.481  1980
1          China          NaN            NaN  1955
2         Norway        2.248         74.340  1975
3         Norway        1.810         75.370  1980
4  United States        2.016         71.340  1975
5  United States        1.788         73.380  1980
```

```
         country  life_expect  year  p_fertility  p_life_expect
0         Norway        75.37  1975        2.248         74.340
1  United States        74.65  1980        1.788         73.380
2      Argentina          NaN  1980        3.440         68.481
3          China          NaN  1955          NaN            NaN
4         Norway          NaN  1980        1.810         75.370
5  United States          NaN  1975        2.016         71.340
```
]]


---
### Parameter *left_on* &amp; *right_on*
- left_on : label or list, or array-like
- Column or index level names to join on in the left DataFrame. Can also be an array or list of arrays of the length of the left DataFrame. These arrays are treated as if they are columns.

- right_on : label or list, or array-like
- Column or index level names to join on in the right DataFrame. Can also be an array or list of arrays of the length of the right DataFrame. These arrays are treated as if they are columns.

- In other words, merge different dataframes with different column names
---

class: split-40
count: false
 

 
.column[.content[

```python
*df1
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

*diff_name = df2.rename(columns={'country':'Desh',
*                              'year':"Year"}).iloc[0:3,:]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
*diff_name
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

*#merge on one columns
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
*pd.merge(df1,diff_name, left_on='country', right_on='Desh')
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
pd.merge(df1,diff_name, left_on='country', right_on='Desh')  

*#merge on two columns
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
pd.merge(df1,diff_name, left_on='country', right_on='Desh')  

#merge on two columns  
*pd.merge(df1,diff_name, left_on=['country','year'], right_on=['Desh','Year'])
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
pd.merge(df1,diff_name, left_on='country', right_on='Desh')  

#merge on two columns  
pd.merge(df1,diff_name, left_on=['country','year'], right_on=['Desh','Year'])  

*#arrange columns
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
pd.merge(df1,diff_name, left_on='country', right_on='Desh')  

#merge on two columns  
pd.merge(df1,diff_name, left_on=['country','year'], right_on=['Desh','Year'])  

#arrange columns  
*arrange_cols = ['country', 'Desh', 'Year','year', 'life_expect',
*'p_fertility','p_life_expect']
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
pd.merge(df1,diff_name, left_on='country', right_on='Desh')  

#merge on two columns  
pd.merge(df1,diff_name, left_on=['country','year'], right_on=['Desh','Year'])  

#arrange columns  
arrange_cols = ['country', 'Desh', 'Year','year', 'life_expect',  
'p_fertility','p_life_expect']  
*pd.merge(df1,diff_name, left_on=['country','year'],
*right_on=['Desh','Year'])[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country    Desh  Year  year  life_expect  p_fertility  p_life_expect
0  Norway  Norway  1975  1975        75.37        2.248          74.34
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1  

diff_name = df2.rename(columns={'country':'Desh',  
                               'year':"Year"}).iloc[0:3,:]  
diff_name  

#merge on one columns  
pd.merge(df1,diff_name, left_on='country', right_on='Desh')  

#merge on two columns  
pd.merge(df1,diff_name, left_on=['country','year'], right_on=['Desh','Year'])  

#arrange columns  
arrange_cols = ['country', 'Desh', 'Year','year', 'life_expect',  
'p_fertility','p_life_expect']  
pd.merge(df1,diff_name, left_on=['country','year'],  
right_on=['Desh','Year'])[arrange_cols]  
```
]]
.column[.content[

```
         country  life_expect  year
0         Norway        75.37  1975
1  United States        74.65  1980
```

```
        Desh  p_fertility  p_life_expect  Year
0  Argentina        3.440         68.481  1980
1      China          NaN            NaN  1955
2     Norway        2.248         74.340  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country  life_expect  year    Desh  p_fertility  p_life_expect  Year
0  Norway        75.37  1975  Norway        2.248          74.34  1975
```

```
  country    Desh  Year  year  life_expect  p_fertility  p_life_expect
0  Norway  Norway  1975  1975        75.37        2.248          74.34
```
]]


---
### Parameter *sort*
- Sort the join keys lexicographically in the result DataFrame. If False, the order of the join keys depends on the join type (how keyword).
- We will see sort while merging using one column and both columns.
- On next slide, we will see for one column.

---

class: split-40
count: false
 

 
.column[.content[

```python
*df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
*df1
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
*df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
*df2
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
df2  
*arrange_cols = ['country', 'year', 'life_expect', 'p_fertility','p_life_expect']
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
df2  
arrange_cols = ['country', 'year', 'life_expect', 'p_fertility','p_life_expect']  

*pd.merge(df1,df2, how='outer', sort=False)[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248         74.340
1  United States  1980        74.65        1.788         73.380
2            NaN  1980          NaN        3.440         68.481
3            NaN  1955          NaN          NaN            NaN
4            NaN  1980          NaN        1.810         75.370
5            NaN  1975          NaN        2.016         71.340
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
df2  
arrange_cols = ['country', 'year', 'life_expect', 'p_fertility','p_life_expect']  

pd.merge(df1,df2, how='outer', sort=False)[arrange_cols]  
*pd.merge(df1,df2, how='outer', sort=True)[arrange_cols]
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248         74.340
1  United States  1980        74.65        1.788         73.380
2            NaN  1980          NaN        3.440         68.481
3            NaN  1955          NaN          NaN            NaN
4            NaN  1980          NaN        1.810         75.370
5            NaN  1975          NaN        2.016         71.340
```

```
         country  year  life_expect  p_fertility  p_life_expect
0  United States  1980        74.65        1.788         73.380
1            NaN  1980          NaN        1.810         75.370
2            NaN  1975          NaN        2.016         71.340
3         Norway  1975        75.37        2.248         74.340
4            NaN  1980          NaN        3.440         68.481
5            NaN  1955          NaN          NaN            NaN
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
df2  
arrange_cols = ['country', 'year', 'life_expect', 'p_fertility','p_life_expect']  

pd.merge(df1,df2, how='outer', sort=False)[arrange_cols]  
pd.merge(df1,df2, how='outer', sort=True)[arrange_cols]  
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248         74.340
1  United States  1980        74.65        1.788         73.380
2            NaN  1980          NaN        3.440         68.481
3            NaN  1955          NaN          NaN            NaN
4            NaN  1980          NaN        1.810         75.370
5            NaN  1975          NaN        2.016         71.340
```

```
         country  year  life_expect  p_fertility  p_life_expect
0  United States  1980        74.65        1.788         73.380
1            NaN  1980          NaN        1.810         75.370
2            NaN  1975          NaN        2.016         71.340
3         Norway  1975        75.37        2.248         74.340
4            NaN  1980          NaN        3.440         68.481
5            NaN  1955          NaN          NaN            NaN
```
]]



---
- see the order of country on both sort
---

class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
df2  
arrange_cols = ['country', 'year', 'life_expect', 'p_fertility','p_life_expect']  

pd.merge(df1,df2, how='outer', sort=False)[arrange_cols] #ROTATE  
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```

```
         country  year  life_expect  p_fertility  p_life_expect
0         Norway  1975        75.37        2.248         74.340
1  United States  1980        74.65        1.788         73.380
2            NaN  1980          NaN        3.440         68.481
3            NaN  1955          NaN          NaN            NaN
4            NaN  1980          NaN        1.810         75.370
5            NaN  1975          NaN        2.016         71.340
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,3,6]].reset_index(drop=True)  
df1  
df2 = df.iloc[[5,10,24,25,34,35], [6,7,8]].reset_index(drop=True)  
df2  
arrange_cols = ['country', 'year', 'life_expect', 'p_fertility','p_life_expect']  

*pd.merge(df1,df2, how='outer', sort=True)[arrange_cols] #ROTATE
```
]]
.column[.content[

```
         country  life_expect  p_fertility
0         Norway        75.37        2.248
1  United States        74.65        1.788
```

```
   p_fertility  p_life_expect  year
0        3.440         68.481  1980
1          NaN            NaN  1955
2        2.248         74.340  1975
3        1.810         75.370  1980
4        2.016         71.340  1975
5        1.788         73.380  1980
```

```
         country  year  life_expect  p_fertility  p_life_expect
0  United States  1980        74.65        1.788         73.380
1            NaN  1980          NaN        1.810         75.370
2            NaN  1975          NaN        2.016         71.340
3         Norway  1975        75.37        2.248         74.340
4            NaN  1980          NaN        3.440         68.481
5            NaN  1955          NaN          NaN            NaN
```
]]



---
### Parameter *sort* 
- Keep your eyes open for sorting on two columns (year first and then country)

---

class: split-40
count: false
 

 
.column[.content[

```python
*df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)  
*df1
```
]]
.column[.content[

```
   year        country  life_expect  p_fertility
0  1975         Norway        75.37        2.248
1  1980  United States        74.65        1.788
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)  
df1  

*df2 = df.iloc[[5,10,24,25,34,35], [8,1,6,7]].reset_index(drop=True)
```
]]
.column[.content[

```
   year        country  life_expect  p_fertility
0  1975         Norway        75.37        2.248
1  1980  United States        74.65        1.788
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [8,1,6,7]].reset_index(drop=True)  
*df2
```
]]
.column[.content[

```
   year        country  life_expect  p_fertility
0  1975         Norway        75.37        2.248
1  1980  United States        74.65        1.788
```

```
   year        country  p_fertility  p_life_expect
0  1980      Argentina        3.440         68.481
1  1955          China          NaN            NaN
2  1975         Norway        2.248         74.340
3  1980         Norway        1.810         75.370
4  1975  United States        2.016         71.340
5  1980  United States        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [8,1,6,7]].reset_index(drop=True)  
df2  
*pd.merge(df2,df1, how='outer')
```
]]
.column[.content[

```
   year        country  life_expect  p_fertility
0  1975         Norway        75.37        2.248
1  1980  United States        74.65        1.788
```

```
   year        country  p_fertility  p_life_expect
0  1980      Argentina        3.440         68.481
1  1955          China          NaN            NaN
2  1975         Norway        2.248         74.340
3  1980         Norway        1.810         75.370
4  1975  United States        2.016         71.340
5  1980  United States        1.788         73.380
```

```
   year        country  p_fertility  p_life_expect  life_expect
0  1980      Argentina        3.440         68.481          NaN
1  1955          China          NaN            NaN          NaN
2  1975         Norway        2.248         74.340        75.37
3  1980         Norway        1.810         75.370          NaN
4  1975  United States        2.016         71.340          NaN
5  1980  United States        1.788         73.380        74.65
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [8,1,6,7]].reset_index(drop=True)  
df2  
pd.merge(df2,df1, how='outer')  
*pd.merge(df2,df1, how='outer', sort=True)
```
]]
.column[.content[

```
   year        country  life_expect  p_fertility
0  1975         Norway        75.37        2.248
1  1980  United States        74.65        1.788
```

```
   year        country  p_fertility  p_life_expect
0  1980      Argentina        3.440         68.481
1  1955          China          NaN            NaN
2  1975         Norway        2.248         74.340
3  1980         Norway        1.810         75.370
4  1975  United States        2.016         71.340
5  1980  United States        1.788         73.380
```

```
   year        country  p_fertility  p_life_expect  life_expect
0  1980      Argentina        3.440         68.481          NaN
1  1955          China          NaN            NaN          NaN
2  1975         Norway        2.248         74.340        75.37
3  1980         Norway        1.810         75.370          NaN
4  1975  United States        2.016         71.340          NaN
5  1980  United States        1.788         73.380        74.65
```

```
   year        country  p_fertility  p_life_expect  life_expect
0  1955          China          NaN            NaN          NaN
1  1975         Norway        2.248         74.340        75.37
2  1975  United States        2.016         71.340          NaN
3  1980      Argentina        3.440         68.481          NaN
4  1980         Norway        1.810         75.370          NaN
5  1980  United States        1.788         73.380        74.65
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [8,1,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [8,1,6,7]].reset_index(drop=True)  
df2  
pd.merge(df2,df1, how='outer')  
pd.merge(df2,df1, how='outer', sort=True)  
```
]]
.column[.content[

```
   year        country  life_expect  p_fertility
0  1975         Norway        75.37        2.248
1  1980  United States        74.65        1.788
```

```
   year        country  p_fertility  p_life_expect
0  1980      Argentina        3.440         68.481
1  1955          China          NaN            NaN
2  1975         Norway        2.248         74.340
3  1980         Norway        1.810         75.370
4  1975  United States        2.016         71.340
5  1980  United States        1.788         73.380
```

```
   year        country  p_fertility  p_life_expect  life_expect
0  1980      Argentina        3.440         68.481          NaN
1  1955          China          NaN            NaN          NaN
2  1975         Norway        2.248         74.340        75.37
3  1980         Norway        1.810         75.370          NaN
4  1975  United States        2.016         71.340          NaN
5  1980  United States        1.788         73.380        74.65
```

```
   year        country  p_fertility  p_life_expect  life_expect
0  1955          China          NaN            NaN          NaN
1  1975         Norway        2.248         74.340        75.37
2  1975  United States        2.016         71.340          NaN
3  1980      Argentina        3.440         68.481          NaN
4  1980         Norway        1.810         75.370          NaN
5  1980  United States        1.788         73.380        74.65
```
]]



---
- country and then year
---

class: split-40
count: false
 

 
.column[.content[

```python
*df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)
```
]]
.column[.content[

]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
*df1
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

*df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
*df2
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  
*pd.merge(df2,df1, how='outer')
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect
0      Argentina  1980        3.440         68.481          NaN
1          China  1955          NaN            NaN          NaN
2         Norway  1975        2.248         74.340        75.37
3         Norway  1980        1.810         75.370          NaN
4  United States  1975        2.016         71.340          NaN
5  United States  1980        1.788         73.380        74.65
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  
pd.merge(df2,df1, how='outer')  
*pd.merge(df2,df1, how='outer', sort=True)
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect
0      Argentina  1980        3.440         68.481          NaN
1          China  1955          NaN            NaN          NaN
2         Norway  1975        2.248         74.340        75.37
3         Norway  1980        1.810         75.370          NaN
4  United States  1975        2.016         71.340          NaN
5  United States  1980        1.788         73.380        74.65
```

```
         country  year  p_fertility  p_life_expect  life_expect
0      Argentina  1980        3.440         68.481          NaN
1          China  1955          NaN            NaN          NaN
2         Norway  1975        2.248         74.340        75.37
3         Norway  1980        1.810         75.370          NaN
4  United States  1975        2.016         71.340          NaN
5  United States  1980        1.788         73.380        74.65
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  
pd.merge(df2,df1, how='outer')  
pd.merge(df2,df1, how='outer', sort=True)  
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect
0      Argentina  1980        3.440         68.481          NaN
1          China  1955          NaN            NaN          NaN
2         Norway  1975        2.248         74.340        75.37
3         Norway  1980        1.810         75.370          NaN
4  United States  1975        2.016         71.340          NaN
5  United States  1980        1.788         73.380        74.65
```

```
         country  year  p_fertility  p_life_expect  life_expect
0      Argentina  1980        3.440         68.481          NaN
1          China  1955          NaN            NaN          NaN
2         Norway  1975        2.248         74.340        75.37
3         Norway  1980        1.810         75.370          NaN
4  United States  1975        2.016         71.340          NaN
5  United States  1980        1.788         73.380        74.65
```
]]


---
### parameter indictor
- If True, adds a column to output DataFrame called “_merge” with information on the source of each row. If string, column with information on source of each row will be added to output DataFrame, and column will be named value of string.

- Information column is Categorical-type and takes on a value of “left_only” for observations whose merge key only appears in ‘left’ DataFrame, “right_only” for observations whose merge key only appears in ‘right’ DataFrame, and “both” if the observation’s merge key is found in both.

---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  

pd.merge(df2,df1, how='outer', sort=True, indicator=True) #ROTATE  
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect     _merge
0      Argentina  1980        3.440         68.481          NaN  left_only
1          China  1955          NaN            NaN          NaN  left_only
2         Norway  1975        2.248         74.340        75.37       both
3         Norway  1980        1.810         75.370          NaN  left_only
4  United States  1975        2.016         71.340          NaN  left_only
5  United States  1980        1.788         73.380        74.65       both
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  

*pd.merge(df2,df1, how='outer', sort=False, indicator=True) #ROTATE
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect     _merge
0      Argentina  1980        3.440         68.481          NaN  left_only
1          China  1955          NaN            NaN          NaN  left_only
2         Norway  1975        2.248         74.340        75.37       both
3         Norway  1980        1.810         75.370          NaN  left_only
4  United States  1975        2.016         71.340          NaN  left_only
5  United States  1980        1.788         73.380        74.65       both
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  

*pd.merge(df2,df1, how='inner', sort=True, indicator=True) #ROTATE
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect _merge
0         Norway  1975        2.248          74.34        75.37   both
1  United States  1980        1.788          73.38        74.65   both
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  

*pd.merge(df2,df1, how='left', sort=True, indicator=True) #ROTATE
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect     _merge
0      Argentina  1980        3.440         68.481          NaN  left_only
1          China  1955          NaN            NaN          NaN  left_only
2         Norway  1975        2.248         74.340        75.37       both
3         Norway  1980        1.810         75.370          NaN  left_only
4  United States  1975        2.016         71.340          NaN  left_only
5  United States  1980        1.788         73.380        74.65       both
```
]]
---
class: split-40
count: false
 

 
.column[.content[

```python
df1 = df.iloc[[24,35], [1,8,3,6]].reset_index(drop=True)  
df1  

df2 = df.iloc[[5,10,24,25,34,35], [1,8,6,7]].reset_index(drop=True)  
df2  

*pd.merge(df2,df1, how='right', sort=True, indicator=True) #ROTATE
```
]]
.column[.content[

```
         country  year  life_expect  p_fertility
0         Norway  1975        75.37        2.248
1  United States  1980        74.65        1.788
```

```
         country  year  p_fertility  p_life_expect
0      Argentina  1980        3.440         68.481
1          China  1955          NaN            NaN
2         Norway  1975        2.248         74.340
3         Norway  1980        1.810         75.370
4  United States  1975        2.016         71.340
5  United States  1980        1.788         73.380
```

```
         country  year  p_fertility  p_life_expect  life_expect _merge
0         Norway  1975        2.248          74.34        75.37   both
1  United States  1980        1.788          73.38        74.65   both
```
]]


---







&lt;style type="text/css"&gt;
.remark-code{line-height: 1.5; font-size: 50%}
&lt;/style&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:10",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
